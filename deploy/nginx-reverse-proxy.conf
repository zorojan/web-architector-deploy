server {
  listen 80;
  server_name example.com;

  # Frontend (static/Vite) served at root
  location / {
    proxy_pass http://127.0.0.1:5173; # or your static server (nginx, Caddy, etc.)
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

  # Admin (Next.js) mounted under /admin
  location /admin/ {
    proxy_pass http://127.0.0.1:3000/; # Next.js server
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

  # Backend API mounted under /api
  location /api/ {
    proxy_pass http://127.0.0.1:3001/api/; # Express backend
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

  # static assets cache rule (optional)
  location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico|woff2?)$ {
    expires 30d;
    add_header Cache-Control "public, immutable";
  }
}
